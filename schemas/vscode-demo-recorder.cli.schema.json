{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "properties": {
    "$schema": {
      "description": "JSON Schema reference for IDE support",
      "type": "string"
    },
    "version": {
      "default": "1.0",
      "description": "Config schema version",
      "type": "string",
      "const": "1.0"
    },
    "paths": {
      "default": {},
      "type": "object",
      "properties": {
        "extensionRoot": {
          "default": ".",
          "description": "Path to the VS Code extension root (relative to config file or absolute)",
          "type": "string"
        },
        "fixturesDir": {
          "default": "demos/fixtures",
          "description": "Path to fixture files directory",
          "type": "string"
        },
        "outputDir": {
          "default": "demos/04-vscode-demo-recorder/output",
          "description": "Path to output directory (screenshots, reports)",
          "type": "string"
        },
        "goldensDir": {
          "default": "demos/04-vscode-demo-recorder/goldens",
          "description": "Path to golden files directory",
          "type": "string"
        },
        "gifOutputDir": {
          "default": "images",
          "description": "Path to final GIF output directory",
          "type": "string"
        }
      },
      "required": [
        "extensionRoot",
        "fixturesDir",
        "outputDir",
        "goldensDir",
        "gifOutputDir"
      ],
      "additionalProperties": false
    },
    "vscode": {
      "default": {},
      "type": "object",
      "properties": {
        "settings": {
          "default": {
            "git.enabled": false,
            "git.autoRepositoryDetection": false,
            "git.openRepositoryInParentFolders": "never",
            "chat.commandCenter.enabled": false,
            "workbench.startupEditor": "none",
            "workbench.tips.enabled": false,
            "update.showReleaseNotes": false,
            "extensions.ignoreRecommendations": true,
            "telemetry.telemetryLevel": "off"
          },
          "description": "VS Code settings.json to pre-seed in the test instance",
          "type": "object",
          "propertyNames": {
            "type": "string"
          },
          "additionalProperties": {}
        },
        "fontZoomLevel": {
          "default": 3,
          "description": "Number of font zoom-in steps for GIF readability",
          "type": "integer",
          "minimum": 0,
          "maximum": 10
        },
        "cliFlags": {
          "default": [
            "--wait",
            "--disable-gpu",
            "--skip-welcome",
            "--skip-release-notes",
            "--disable-workspace-trust"
          ],
          "description": "Additional CLI flags for the VS Code test instance",
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "wipeUserData": {
          "default": true,
          "description": "Wipe user-data directory before each run for a clean state",
          "type": "boolean"
        }
      },
      "required": [
        "settings",
        "fontZoomLevel",
        "cliFlags",
        "wipeUserData"
      ],
      "additionalProperties": false
    },
    "gif": {
      "default": {},
      "type": "object",
      "properties": {
        "frameDelay": {
          "default": 150,
          "description": "Centiseconds between frames (150 = 1.5s per frame)",
          "type": "integer",
          "exclusiveMinimum": 0,
          "maximum": 9007199254740991
        },
        "width": {
          "default": 1440,
          "description": "Output GIF width in pixels",
          "type": "integer",
          "exclusiveMinimum": 0,
          "maximum": 9007199254740991
        },
        "lossy": {
          "default": 30,
          "description": "gifsicle lossy compression level (0=lossless, higher=more compression)",
          "type": "integer",
          "minimum": 0,
          "maximum": 200
        },
        "colors": {
          "default": 256,
          "description": "Max colors in GIF palette",
          "type": "integer",
          "minimum": 2,
          "maximum": 256
        },
        "dither": {
          "default": "sierra2_4a",
          "description": "ffmpeg dither algorithm (sierra2_4a, bayer, floyd_steinberg, none)",
          "type": "string"
        },
        "statsMode": {
          "default": "full",
          "description": "ffmpeg palettegen stats_mode",
          "type": "string",
          "enum": [
            "full",
            "diff",
            "single"
          ]
        }
      },
      "required": [
        "frameDelay",
        "width",
        "lossy",
        "colors",
        "dither",
        "statsMode"
      ],
      "additionalProperties": false
    },
    "scenarios": {
      "minItems": 1,
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Unique scenario identifier (used as directory name)"
          },
          "description": {
            "description": "Human-readable description",
            "type": "string"
          },
          "steps": {
            "minItems": 1,
            "type": "array",
            "items": {
              "oneOf": [
                {
                  "type": "object",
                  "properties": {
                    "action": {
                      "type": "string",
                      "const": "open"
                    },
                    "fixture": {
                      "type": "string",
                      "description": "Fixture filename relative to fixtures directory"
                    }
                  },
                  "required": [
                    "action",
                    "fixture"
                  ],
                  "additionalProperties": false
                },
                {
                  "type": "object",
                  "properties": {
                    "action": {
                      "type": "string",
                      "const": "selectAll"
                    }
                  },
                  "required": [
                    "action"
                  ],
                  "additionalProperties": false
                },
                {
                  "type": "object",
                  "properties": {
                    "action": {
                      "type": "string",
                      "const": "command"
                    },
                    "command": {
                      "type": "string",
                      "description": "VS Code command ID to execute"
                    },
                    "args": {
                      "description": "Arguments to pass to the command",
                      "type": "object",
                      "propertyNames": {
                        "type": "string"
                      },
                      "additionalProperties": {}
                    }
                  },
                  "required": [
                    "action",
                    "command"
                  ],
                  "additionalProperties": false
                },
                {
                  "type": "object",
                  "properties": {
                    "action": {
                      "type": "string",
                      "const": "verify"
                    },
                    "golden": {
                      "type": "string",
                      "description": "Golden file label (e.g. '01-single-line-before')"
                    }
                  },
                  "required": [
                    "action",
                    "golden"
                  ],
                  "additionalProperties": false
                },
                {
                  "type": "object",
                  "properties": {
                    "action": {
                      "type": "string",
                      "const": "screenshot"
                    },
                    "label": {
                      "type": "string",
                      "description": "Screenshot label for filename"
                    }
                  },
                  "required": [
                    "action",
                    "label"
                  ],
                  "additionalProperties": false
                },
                {
                  "type": "object",
                  "properties": {
                    "action": {
                      "type": "string",
                      "const": "sleep"
                    },
                    "ms": {
                      "type": "integer",
                      "exclusiveMinimum": 0,
                      "maximum": 9007199254740991,
                      "description": "Milliseconds to wait"
                    }
                  },
                  "required": [
                    "action",
                    "ms"
                  ],
                  "additionalProperties": false
                },
                {
                  "type": "object",
                  "properties": {
                    "action": {
                      "type": "string",
                      "const": "closeEditor"
                    }
                  },
                  "required": [
                    "action"
                  ],
                  "additionalProperties": false
                }
              ]
            },
            "description": "Ordered list of steps to execute"
          }
        },
        "required": [
          "name",
          "steps"
        ],
        "additionalProperties": false
      },
      "description": "List of scenarios to record"
    }
  },
  "required": [
    "version",
    "paths",
    "vscode",
    "gif",
    "scenarios"
  ],
  "additionalProperties": false
}
